ESET researchers have located the point from which the global cyber epidemic has started. Attackers have successfully compromised the accounting software M.E.Doc, popular across various industries in Ukraine, including financial institutions. Several of them executed a trojanized update of M.E.Doc, which allowed attackers to launch the massive ransomware campaign today which spread across the whole country and to the whole world. M.E.Doc has today released a warning on their website which you can view here. Numerous reports are coming out on social media about a new ransomware attack in Ukraine, which could be related to the Petya family, which is currently detected by ESET as Win32/Diskcoder.C Trojan. If it successfully infects the MBR, it will encrypt the whole drive itself. Otherwise, it encrypts all files, like Mischa. For spreading, it appears to be using a combination of the SMB exploit (EternalBlue) used by WannaCryptor for getting inside the network, then spreading through PsExec for spreading within the network. This dangerous combination may be the reason why this outbreak has spread globally and rapidly, even after the previous outbreaks have generated media headlines and hopefully most vulnerabilities have been patched. It only takes one unpatched computer to get inside the network, and the malware can get administrator rights and spread to other computers. Journalist, Christian Borys tweeted that the cyberattack has “allegedly hit” banks, power grid and postal companies, among others. Moreover, it appears that the government has also come under attack. Borys has also tweeted an image put up on Facebook by Ukraine’s deputy prime minister, Pavlo Rozenko, which shows a computer apparently being encrypted. The National Bank of Ukraine has also warned other banks of the ransomware attack on its website. It stated: “Currently, the financial sector strengthened security measures and counter hacker attacks all financial market participants.” Forbes said that while there appear to be similarities with WannaCryptor – with others describing it as WannaCry-esque – it is likely to be a variant of Petya. An image, similar to the one witnessed by WannaCryptor victims, reportedly showing the ransomware message is making the rounds online, with one from Group-IB showing the following message (paraphrased): “If you see this text, then your files are no longer accessible, because they have been encrypted… We guarantee that you can recover all your files safely and easily. All you need to do is submit the payment [$300 bitcoins] and purchase the decryption key.” However, a spokesman said that there have been no effect on power supplies, although it may be too early to ascertain this. The ransomware attack is not specific to only Ukraine and countries all around the globe need to beware. The Independent said that Spain and India may also have been affected, as well as the Danish shipping company Maersk and the British advertising company WPP. On WPP’s homepage, their message read: “The WPP web site is currently unavailable due to important routine maintenance normal service will resume shortly. WPP has since confirmed on Twitter that it has been the victim of an attack stating that IT systems in several WPP companies have been affected by a suspected cyberattack. And that they will be taking appropriate measures and will update ASAP. There are also reports that payments are being made in response to the attack, at the BTC address linked here. Petya took an approach different from that of other crypto-ransomware. Instead of encrypting files individually, it aimed at the file system. “The target is the victim’s master boot record (MBR), which is responsible for loading the operating system right after system boot.” In order to prevent this kind of threat, ESET recommends that you always have your systems fully patched, that you use a proper security solution and that you set up network segmentation, which might help prevent spreading within the network. For more on Petya, check out this insightful piece from 2016 and to find out about ESET security software visit the ESET website. This article was published in partnership with ESET.